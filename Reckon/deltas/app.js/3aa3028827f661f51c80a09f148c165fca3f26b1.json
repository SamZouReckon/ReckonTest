["/*aad9eb7d6466d6e93a12a70f13ab3bae9525cb9f",42,556304,"Consts\",{alternateClassName:\"RM.Consts\",singleton:true,",624534,70,"20000,STORE_LOAD_TIME_OUT:12",624631,539,",NoAccessMsg:\"No access rights\"",556323,129,".map(function(b){return b.toLowerCase?b.toLowerCase():b})",556452,86,".toLowerCase()",556538,75,"pprove",556671,34,"Approve\"",556606,213,"canSelect",556671,34,"Selec",556814,1462,"if(!RM.PermissionsMgr.canView(\"PAndLReport\")",558274,52,"dashboard-nodata\">'+RM.Consts.NoAccessMsg+\"</div>\");return}",558276,480,"Expenses))+'</span>",558776,170,558954,236,"msg\",flex:1},",559181,50,",{itemId:\"blankCont\",flex:1",698192,55,559285,181,"d){var b=this.getComponent(1);var e=RM.PermissionsMgr.canView(\"Invoices\");var a=RM.PermissionsMgr.canView(\"Bills\");var c=b.getComponent(\"msg\");c.setHidden(e||a);c",560676,43,"'+RM.Consts.NoAccessMsg+\"</div>\");b.getComponent(\"invoices\").setHidden(!e);b.getComponent(\"bills\").setHidden(!a);b.getComponent(\"blankCont\").setHidden(!(e||a)||(e&&a));if(!e&&!a){return}b",559489,96,"d",559586,226,"d",559813,78,"b",559911,91,"'+d.Bill",559594,110,"Bill",559711,32,"Due",560127,38,"$'+RM.AppMgr.valueWithCommas(d.Bill",559821,69,"},onBillsTap:function(){RM.ViewMgr.showBills()",560243,391,"!RM.PermissionsMgr.canView(\"AccountEnquiryReport\")",560654,65,"'+RM.Consts.NoAccessMsg+\"</div>\");return}",560631,1657,"!RM.PermissionsMgr.canView(\"Budgets\")",562308,85,"'+RM.Consts.NoAccessMsg+\"</div>\"});return}",562285,2141,"SecurePanel\",{extend:Ext.Panel,xtype:\"secure",592829,180,"View(a)){RM.AppMgr.showErrorMsgBox(\"You are not permitted to view this screen\"",605135,37,564397,291,"Secure",565648,34,575373,477,564678,3248,"RM.component.Secure",567930,39,"permissionFor:\"Invoices",707872,60,568027,99,576040,35,"\"Invoices",714528,39,676032,47,568210,7113,"view.Contacts\",{extend:RM.component.SecurePanel,xtype:\"contacts\",config:{permissionFor:\"Contacts",707872,60,575966,2811,"Cashbook",578780,1157,"clearFilter();",579926,1605,"this.hideKeyPad();",581586,62,"this.appBackStack.pop();this.showDashboard(b);",581648,68,"a.onAfter(\"erased\",function(){this",581760,100,"this.hideKeyPad()",581920,32,"var d=this.appBackStack.pop();var e=[d];d.onAfter(\"erased\",function(){e.forEach(function(f){f.destroy()})});while(this.appBackStack.length>0){var ",582021,61,"=b){this.showPanel(a,c);break}e.push(a)}},appPause:function(){document.activeElement.blur();",582237,66,582211,1901,"this.hideKeyPad();",584167,193,"this.hideKeyPad();",584415,382,"this.hideKeyPad();",584852,1035,"hideKeyPad:function(",584110,57,585885,6879,"re.CashbookMgr\",{alternateClassName:\"RM.CashbookMgr\",singleton:true,config:{cashbookId:null,currentCashbook:null},getTaxPreferences:function(){return this.getCurrentCashbook().TaxPreference},getSalesPreferences:function(){return this.getCurrentCashbook().SalesPreferences},loadLastCashbook:function(a){if(this.getCashbookId()){this.setCashbook(this.getCashbookId());if(a){a()}}",627419,72,"setCashbookId(a.CashBookId)",627514,110,627635,178,"_currentCashbook.Dashboard",627826,65,"c,a,b){RM.AppMgr",627904,50,"c},function(d){this.setCashbookId(c);this.setCurrentCashbook(d[0",625663,33,"GSTCodes\").setData(d[0].GSTCodes",625664,32,"AccountingCategories\").setData(d",628095,76,"d",628172,48,"this.getCurrentCashbook().Permissions)",628309,48,575305,34,592778,368,593021,39,"d){var c=d.config.permissionFor;if(c){var b=RM.PermissionsMgr.canDo(c.name,c.action);if(c.invoke){d[c.invoke].apply(d,[b])}else{if(c.invokeWithInverse){d[c.invoke].apply(d,[!b])}else{d.setHidden(!b)}}}",589198,34,593178,1464,"RM.component.Secure",594646,36,"permissionFor:\"Contacts",707872,64,"back\",",618208,39,614976,32,602457,44,605915,55,594920,380,"\"Display ",596395,32,595359,9849,713343,781,",b",714124,52,";b.stopPropagation(",593688,32,"AmountField\",{extend:RM.component.ExtTextField,xtype:\"rmamoun",589279,57,"this.on(\"focus\",this.onFieldFocus,this)},onFieldFocus:function(d,c){this.fieldUniqueId=c.target.id;if(this.keypadOnTop){return}this.owningPanel=d.up(\"panel\");var b=",714978,53,",listeners:{keytap:this.onKeyTap,scope:this}};this.keypad=this.owningPanel.add(b);this.clearScrollTimer();var a=this.owningPanel",482802,36,"scrollTimer=window.setTimeout(function(){a.scrollTo(0,d.element.dom.offsetTop,true)},200);this.keypadOnTop=true;this.simulateCursor(d);this.rootContainer=this.getRootContainer(this.owningPanel);this.rootContainer.element.on({tap:this.handleTapInEntireScreen,scope:this})},removeKeypad:function(){var b=this.getValue();if(this.config.decimalPlaces&&b!=\"\"){this.setValue(this.getPrefix()+Ext.Number.toFixed(parseFloat(b),this.config.decimalPlaces))}",589838,59,";this.setPlaceHolder(this.config.placeHolder)}if(this.keypadOnTop){this.owningPanel.remove(this.keypad);this.keypadOnTop=false}this.clearScrollTimer();var a=this.owningPanel",482802,36,"scrollTimer=window.setTimeout(function(){a.scrollTo(0,0,true)},200)},onKeyTap:function(b){var e=this.getValue();var a=this.getPrefix()+e.toString();var d=a.length;var c=a.indexOf(\".\");if(b===\"back\"){if(d>0){a=a.slice(0,-1);this.setValue(a)}}else{if(this.config.decimalPlaces){if((b!=\".\"&&d-1<c+this.config.decimalPlaces)||c<0){if(a==this.getPrefix()+\"0\"&&b!=\".\"){a=this.getPrefix()}this.setValue(a+b)}}else{if(c!=-1&&b==\".\"){return}if(a==this.getPrefix()+\"0\"){a=this.getPrefix()}this.setValue(a+b)}}},get",601700,39,");var a=b.toString();if(this.config.prefix&&a.indexOf(this.config.prefix)!=-1){a=a.slice(this.getPrefix().length)}return a},applyValue:function(b,a){var c=b.toString();if(c.indexOf(this.config.prefix)==-1&&c!==\"\"){c=this.config.prefix+c}return c},handleTapInEntireScreen:function(a){if(this.fieldUniqueId!==a.target.id){this.removeKeypad()}},getRootContainer:function(a){while(a.getParent()){a=a.getParent()}return a},getPrefix:function(){return(this.config.prefix?this.config.prefix:\"\")},simulateCursor",589614,203,"clearScrollTimer:function(){if(this.scrollTimer){window.clearTimeout(this.scrollTimer)}",605632,1195,"rmamount",606836,54,714688,71,",clearIcon:false,decimalPlaces:2,prefix:\"$",590672,34,602976,33,690126,79,606489,43,"Supplier",602976,33,607259,1410,"TaxStatus:function(a){this.taxStatus",608709,53,"nvoiceDate:function(a){this.invoiceDate",608754,175,"{taxStatus:this.taxStatus,invoiceDate:this.invoiceDate}",608945,522,"LineText",577375,49,609527,568,"{taxStatus:this.taxStatus,invoiceDate:this.invoiceDate}",610111,811,"RM.component.Secure",610926,36,"permissionFor:\"Invoices",707872,127,665392,40,611127,239,595053,32,"Invoices",611375,3524,"secure",614899,138,",permissionFor:\"Invoices",615036,1398,616717,93,"},{text:\"Time\",itemId:\"time\",permissionFor:\"Timesheets_BillEntry\"",616840,37,"permissionFor:\"ExpenseClaims_BillEntry\"}],",617018,53,"a,d){",565326,42,"var b",616543,121,"e){this.hide();a.call(d,e.getItemId())},scope:this}});var c=0;this.items.forEach(function(e){if(!e.permissionFor||RM.PermissionsMgr.getPermission(e.permissionFor)){b.add(e);if(e.itemId){c+=1}}});if(c>1){this.popup=b;b.show()}else{a.call(d,this.items[1].itemId)}},h",660925,44,616947,4858," RM.CashbookMgr.getSalesPreferences().ApprovalProcessEnabled?\"INVOICED\":\"UN",621877,37,621847,100,"getInitialInvoiceStatus:function(){if(RM.CashbookMgr.getSalesPreferences().ApprovalProcessEnabled){return RM.Consts.InvoiceStatus.DRAFT}else{return ",622253,32,"}",621945,235,"this.getInitialInvoiceStatus()",622209,2314,625172,85,625278,1830,"RM.CashbookMgr.getCashbookId()){RM.CashbookMgr.loadLastCashbook(function(){RM.ViewMgr.back()})}else{RM.CashbookMgr",627221,169,"RM.CashbookMgr.selectCashBook()}},this",628355,177,"RM.CashbookMgr",628536,625,"){apiUrl=this.getApiUrl(c)+\"/\"+e;this.getServerRec(apiUrl,{},a,b,d)},getServerRec:function(b,f,a,c,d){var e=this;if(b.substr(0,4)!==\"http\"){b=e.getApiUrl(b)}Ext.Ajax.request({url:b",629707,74,"e",630653,32,629817,75,"c",629893,42,"c",629936,141,";if(d){d.call(c||this,g)}},scope:this});e.setLoadingTimer(",630090,821,"d){var e=this;e.setLoadingTimer();var c=function(g,f,h){e",630653,32,"hideLoadingMask();if(a){a.call(d,g,f,h)}}",630936,33,"g,f,h){if(h){c(g,f,h)}},scope:e",631208,206,"navigator.connection&&navigator.connection.type===\"none\"){this.showOkMsgBox(\"It looks like your device has no internet connection, please connect and try again.\");return}",631411,47,"Text===\"communication failure\"){this.showOkMsgBox(\"The connection failed, please try again or contact support.\")}else{if(a.status!=0){this.showErrorMsgBox(\"There was an error, please try again or contact support: <br/><br/> (\"+a.status+\" \"+a.statusText+\")\")}",631515,118,"qa",631637,275,"qa",631679,33,"r1mobileqa",631801,35,631915,462,632376,5828,"QA Server\",value:\"qa",638188,32348,"init",575479,85,"showDashboardData,scope:this})",670534,100,")},showDashboardData:function(",670683,64,"this.dashboardDat",670747,32,"this.dashboardDat",670779,37,"this.dashboardDat",670816,52,"this.dashboardDat",670868,912,"username and",671779,91,"textfield\",itemId:\"username\",label:\"Usernam",690583,37,607136,32,657795,32,671867,44,"rmmandatory:true,labelWidth:\"4em",736367,56,671993,742,"userName:\"forgotpassword #username",672733,421,"){var c=true;var b=this.getEmail().getValue();var a=this.getUserName().getValue();this.getEmail().showValidation(true);this.getUserName().showValidation(true)",673167,49,"c=false}if(a==\"\"){this.getUserName().showValidation(false);c",739227,35,"b)",673176,40,"c",673295,38,";return c}if(!c",727215,40,"c},onSend",716784,36,673458,87,"UserName().getValue(),Email",673536,38,"a",673575,36,"b,a){this.showFail(a",673631,2061,"RM.component.SecurePanel,xtype:\"invoices\",config:{permissionFor:\"Invoices",707872,60,618208,136,"Invoic",701566,55,576040,35,"\"Invoices",568111,99,676079,4918,"util.FormUtils\",{singleton:true,makeAllFieldsReadOnly:function(a){a",593025,122,678512,35,644650,50,681065,1224,",dateFld:{change:\"onInvoiceDateChanged",682287,274,"InvoicesMgr.getInitialInvoiceStatus()",683408,46,",Date:new Date(),Discount:\"None\"",682633,76,"&&RM.PermissionsMgr.canAddEdit(\"Invoices\"",682708,242,683040,299,"this.detailsData;if(b.CustomerId){",683592,78,"applyTaxRules(",683663,158,";this.getLineItems().setInvoiceDate(this.getDateFld().getValue());this.getLineItems().setTaxStatus(b.AmountTaxStatus",682943,66,"b.Status));this.dataLoaded=true}}",742368,36,683879,103,"if(!a){RM.util.FormUtils.makeAllFieldsReadOnly(this.getInvoiceForm())}",684125,38,"applyTaxRules:function(){var b=this.getAmountsFld();var a=RM.CashbookMgr.getTaxPreferences();b.setReadOnly(!this.isEditable||!a.AllowTaxEdit);if(this.isCreate){if(a.IsTaxTracking){b.setHidden(false);b.setValue(a.SalesFigures)}else{b.setHidden(true);b.setValue(RM.Consts.TaxStatus.NON_TAXED)}}else{var c=a.IsTaxTracking||b.getValue()!==RM.Consts.TaxStatus.NON_TAXED;b.setHidden(!c)",646840,55,684215,49,711501,64,"c.Status));",684264,378,"applyTaxRules(",684635,108,"CustomerId(c.CustomerId);b.setTaxStatus(c.AmountTaxStatus);b.setInvoiceDate(c.Date",684887,63,";if(this.detailsData.Paid>0){this.isEditable=false;this.setEditable(false)}this.dataLoaded=true},this,function(){this.goBack(",684976,878,"c,a,b",685855,57,"c.getValue();this.getLineItems().setTaxStatus(b)},onInvoiceDateChanged:function(b,a,c){if(!this.dataLoaded){return}this.calculateBreakdown();this.getLineItems().setInvoiceDate(c",685923,476,"g",686400,35,"f",686436,39,"e={InvoiceDate:g.Date,AmountTaxStatus:g",686514,87,"g.Discount.indexOf(\"%\")>-1){e.DiscountPercentage=g",686651,34,"g.Discount.indexOf(\"$\")>-1){e.DiscountAmount=g",686731,41,"f.length;c++){var d=f[c];var b={ItemType:d.ItemType,ItemID:d.ItemId,Quantity:d.Quantity",693462,33,"TaxGroupID:d.TaxGroupId,Tax:d.Tax,TaxIsModified:d.TaxIsModified};if(d",686928,36,"d.DiscountPerc}if(d",686989,34,"d.DiscountAmount}e",687044,62,"e,function a(h){var m=h[0];var l=this.detailsData;l.Amount=m.InvoiceAmount;l.Tax=m.InvoiceTax?m.InvoiceTax:0;l.Subtotal=m.Subtotal;l.DiscountTotal=m.Discount?m.Discount:0;l.Paid=m.AmountPaid;l.BalanceDue=m.BalanceDue;var k=this.getLineItems();k.removeAllItems();for(var j=0;j<f.length;j++){f[j].Amount=m.Items[j].Amount;if(m.Items[j].DiscountAmount){f[j].DiscountAmount=m.Items[j].DiscountAmount}}k.setTaxStatus(e.AmountTaxStatus);k.addLineItems(f",687640,42,"h){alert(h",687692,1695,605198,220,"this.on(\"keyup\",this.valChange);this.on(\"blur\",this.numberPrecision)",605418,215,",valChange:function(a,f,c){var g=this.getValue();console.log(f.browserEvent.keyCode);if(!(47<f.browserEvent.keyCode<58||f.browserEvent.keyCode==190)){f.stopEvent()}if(g===null||g===undefined){console.log(g);return}var b=g.toString();var d=b.length;if(this.config.decimalPlaces&&b.indexOf(\".\")!=-1){if(d-1>(b.indexOf(\".\")+this.config.decimalPlaces)){this.setValue(b.substring(0,d-1))}}console.log(this.getValue()",636180,49,"&&Ext.isNumber(this.config.decimalPlaces)){this.setValue(a.toFixed(this.config.decimalPlaces))",689367,401,595053,32,"Invoices",689777,40,618541,32,689863,39,690032,94,606572,80,"permissionFor:{action:\"Select\",name:\"Projects\"},",690096,152,"itemId:\"descriptionField",690246,41,"[\"rm-flatfield\",\"rm-flatfield-last\"],placeHolder:\"enter\"},{xtype:\"panel\",itemId:\"detailsFields\",defaults:{clearIcon:false},hidden:true,items:[",690323,39,690367,189,620585,50,"0,cls:[\"rm-flatfield\"]",690458,32,"Amount\",label:\"Amount\",value:0",714852,33,690543,215,"numberfield\",name:\"Tax\",label:\"Tax\",cls:[\"rm-flatfield\",\"rm-flatfield-last\"]}]}]}]},showDetailsFields:function(){this.down(\"#descriptionField\").removeCls([\"rm-flatfield-last\"]);this.down(\"#detailsFields\").setHidden(false)},hideDetailsFields:function(){this.down(\"#descriptionField\").addCls(\"rm-flatfield-last\");this.down(\"#detailsFields\").setHidden(true",703728,38,690938,177,691122,34,":\"invoicelineitem field[name=UnitPrice]\",quantity:\"invoicelineitem ",691251,47,"field[name=TaxGroupId]\",tax:\"invoicelineitem field[name=Tax]\",amount:\"invoicelineitem field[name=Amount",691325,32,691364,49,691419,196,",unitPrice:{change:\"unitPriceChanged\"},tax:{change:\"taxAmountChanged\"},quantity:{change:\"quantityChanged\"}}},isTaxInclusive:function(){return this.taxStatusCode===RM.Consts.TaxStatus.INCLUSIVE},showView:function(e,f,d,g,a,c",691647,70,"taxStatusCode=d.taxStatus;this.invoiceDate=d.invoiceDate",724048,36,691766,236,",TaxIsModified:false}}",743897,65,692069,536,"if(!this.isTaxInclusive()){this.getUnitPrice().setValue(this.detailsData.UnitPriceExTax)}this.getTaxCode().setHidden(this.taxStatusCode===RM.Consts.TaxStatus.NON_TAXED);if(this.detailsData.ItemId){this.getItemDetail().showDetailsFields()}",692652,45,"if(!a){RM.util.FormUtils.makeAllFieldsReadOnly(this.getItemForm())}",692844,482,"this.itemChanged(c[0]",693526,220,"!a.UnitPriceExTax){this.getUnitPrice",647264,36,727213,45,693895,226,"Tax:c.Tax,TaxIsModified:this.detailsData.TaxIsModified,UnitPriceExTax:this.detailsData",694137,306,",itemChanged:function(a){this.detailsData.ItemName=a.Name;this.detailsData.UnitPriceExTax=a.UnitPriceExTax;this.detailsData.TaxIsModified=false;this.ignoreEvents=tru",693368,39,"a.ItemId,ItemName:a.ItemPath,TaxGroupId:a.SaleTaxCodeID,Description:a.SalesDescription,UnitPrice:a.UnitPriceExTax});this.ignoreEvents=false;this.getServerCalculatedValues()},unitPriceChanged:function(c,b,a){if(!this.initShow||this.ignoreEvents){return}if(b===a){return}if(this.isTaxInclusive()){this.detailsData.TaxIsModified=false;this.getServerCalculatedValues(b)}else{this.detailsData.UnitPriceExTax=b;this.getServerCalculatedValues()}},taxAmountChanged:function(c,b,a){if(!this.initShow||this.ignoreEvents){return}this.detailsData.TaxIsModified=true;this.getServerCalculatedValues()},projectChanged:function(){},quantityChanged:function(){if(!this.initShow||this.ignoreEvents){return}this.getServerCalculatedValues()},getServerCalculatedValues:function(b){var d={AmountTaxStatus:this.taxStatusCode,PreviousAmountTaxStatus:this.taxStatusCode,CustomerId:this.customerId,InvoiceDate:this.invoiceDate,LineItems:[]}",693917,42,"e={ItemId:c.ItemId,Quantity:c.Quantity,TaxGroupID:c.TaxGroupId,Tax:c.Tax,Amount:c.Amount,TaxIsModified:this.detailsData.TaxIsModified,UnitPriceExTax:this.detailsData.UnitPriceExTax",694178,33,"e",694212,89,"e",694302,59,"b){e.UnitPrice=b}d.LineItems.push(e);",685007,33,"alc\",true,d,function a(g){var f=g[0].Items[0];this.detailsData.UnitPriceExTax=f.UnitPriceExTax;this.ignoreEvents=tru",693368,32,"UnitPrice:this.isTaxInclusive()?f.UnitPrice:f.UnitPriceExTax,Amount:f.Amount,Tax:f.Tax});this.getItemDetail().showDetailsFields();this.ignoreEvents=false},this,function(f){alert(f)},\"Working...\"",703728,38,694479,1444,"RM.component.Secure",695927,40,"permissionFor:\"Invoices",707872,181,"Add time",568059,168,701736,148,696470,12539,"'+(a.AmountTaxStatus!==RM.Consts.TaxStatus.NON_TAXED?'",709389,37,709046,85,"':\"\")+'",709389,37,709168,2423,"var a=!(",711625,59,"&&RM.PermissionsMgr.canApprove(\"Invoices\"",711588,36,"a);var b=!(",711808,58,"&&RM.PermissionsMgr.canApprove(\"Invoices\"",711772,35,"b",711684,90,711867,1466,714195,9389,"text",723590,12701,"secure",736291,575,",permissionFor:{name:\"SalesPreferences\",action:\"View\"}",736866,228,",listeners:{focus:function(b){var a=b.getValue().split(\"\\n\").length;b.setMaxRows(a+2)},keyup:function(b){var a=b.getValue().split(\"\\n\").length;b.setMaxRows(a+2)}}}]",737372,103,737199,1973,"this.getEmail().showValidation(true);",739368,33,"true)",739171,66,739353,67,739238,111,";return b",647550,49,739464,23005,55391,32,".prototype.isNotPreventable=/^(select|a|input|textarea)$/i",762469,682]