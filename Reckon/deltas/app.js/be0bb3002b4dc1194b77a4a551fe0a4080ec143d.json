["/*7ebdbee4212fbce7e8b12ca0387cd1b4e8cf359b",42,556429,"20",556473,957,"pprove",557488,34,"Approve\"",557423,213,"canSelect",557488,34,"Selec",557631,8588,"SecurePanel\",{extend:Ext.Panel,xtype:\"secure",594601,180,"View(a)){RM.AppMgr.showErrorMsgBox(\"You are not permitted to view this screen\"",606889,37,566190,291,577126,517,566471,3248,"RM.component.Secure",569723,39,"permissionFor:\"Invoices",604080,60,569820,99,577833,35,"\"Invoices",737904,39,677680,47,570003,7113,"view.Contacts\",{extend:RM.component.SecurePanel,xtype:\"contacts\",config:{permissionFor:\"Contacts",604080,60,577759,2811,"Cashbook",580573,2856,"this.appBackStack.pop();this.showDashboard(b);",583429,520,"document.activeElement.blur();",583949,10587,"re.CashbookMgr\",{alternateClassName:\"RM.CashbookMgr\",singleton:true,config:{cashbookId:null,currentCashbook:null},getTaxPreferences:function(){return this.getCurrentCashbook().TaxPreference},getSalesPreferences:function(){return this.getCurrentCashbook().SalesPreferences},loadLastCashbook:function(a){if(this.getCashbookId()){this.setCashbook(this.getCashbookId());if(a){a()}}",628524,72,"setCashbookId(a.CashBookId)",628619,110,628740,178,"_currentCashbook.Dashboard",628931,65,"c,a,b){RM.AppMgr",629009,50,"c},function(d){this.setCashbookId(c);this.setCurrentCashbook(d[0",626768,33,"GSTCodes\").setData(d",629124,75,"d",629200,76,"d",629277,48,"this.getCurrentCashbook().Permissions)",629414,48,577098,34,594550,368,594793,39,"d){var c=d.config.permissionFor;if(c){var b=RM.PermissionsMgr.canDo(c.name,c.action);if(c.invoke){d[c.invoke].apply(d,[b])}else{if(c.invokeWithInverse){d[c.invoke].apply(d,[!b])}else{d.setHidden(!b)}}}",590970,34,594950,1464,"RM.component.Secure",596418,36,"permissionFor:\"Contacts",604080,60,596512,10450,714995,781,",b",715776,52,";b.stopPropagation(",595460,32,"AmountField\",{extend:RM.component.ExtTextField,xtype:\"rmamount",672191,56,"this.on(\"focus\",this.onFieldFocus,this)},onFieldFocus:function(d,c){this.fieldUniqueId=c.target.id;if(this.keypadOnTop){return}this.owningPanel=d.up(\"panel\");var b=",716630,53,",listeners:{keytap:this.onKeyTap,scope:this}};this.keypad=this.owningPanel.add(b);this.clearScrollTimer();var a=this.owningPanel",482802,36,"scrollTimer=window.setTimeout(function(){a.scrollTo(0,d.element.dom.offsetTop,true)},200);this.keypadOnTop=true;this.simulateCursor(d);this.rootContainer=this.getRootContainer(this.owningPanel);this.rootContainer.element.on({tap:this.handleTapInEntireScreen,scope:this})},removeKeypad:function(){var b=this.getValue();if(this.config.decimalPlaces&&b!=\"\"){this.setValue(this.getPrefix()+Ext.Number.toFixed(parseFloat(b),this.config.decimalPlaces))}",591610,59,";this.setPlaceHolder(this.config.placeHolder)}if(this.keypadOnTop){this.owningPanel.remove(this.keypad);this.keypadOnTop=false}this.clearScrollTimer();var a=this.owningPanel",482802,36,"scrollTimer=window.setTimeout(function(){a.scrollTo(0,0,true)},200)},onKeyTap:function(b){var e=this.getValue();var a=this.getPrefix()+e.toString();var d=a.length;var c=a.indexOf(\".\");if(b===\"back\"){if(d>0){a=a.slice(0,-1);this.setValue(a)}}else{if(this.config.decimalPlaces){if((b!=\".\"&&d-1<c+this.config.decimalPlaces)||c<0){if(a==this.getPrefix()+\"0\"&&b!=\".\"){a=this.getPrefix()}this.setValue(a+b)}}else{if(c!=-1&&b==\".\"){return}if(a==this.getPrefix()+\"0\"){a=this.getPrefix()}this.setValue(a+b)}}},get",603454,39,");var a=b.toString();if(this.config.prefix&&a.indexOf(this.config.prefix)!=-1){a=a.slice(this.getPrefix().length)}return a},applyValue:function(b,a){var c=b.toString();if(!a&&a!==\"\"){if(this.config.decimalPlaces&&c!==\"\"){c=Ext.Number.toFixed(parseFloat(c),this.config.decimalPlaces)}}if(c.indexOf(this.config.prefix)==-1&&c!==\"\"){c=this.config.prefix+c}return c},handleTapInEntireScreen:function(a){if(this.fieldUniqueId!==a.target.id){this.removeKeypad()}},getRootContainer:function(a){while(a.getParent()){a=a.getParent()}return a},getPrefix:function(){return(this.config.prefix?this.config.prefix:\"\")},simulateCursor",591386,203,"clearScrollTimer:function(){if(this.scrollTimer){window.clearTimeout(this.scrollTimer)}",607386,1195,"rmamount",608590,54,716486,72,"clearIcon:false,decimalPlaces:2,prefix:\"$\"",608784,1639,"TaxStatus:function(a){this.taxStatus",610463,53,"nvoiceDate:function(a){this.invoiceDate",610508,175,"{taxStatus:this.taxStatus,invoiceDate:this.invoiceDate}",610699,522,"LineText",611232,617,"{taxStatus:this.taxStatus,invoiceDate:this.invoiceDate}",611865,811,"RM.component.Secure",612680,36,"permissionFor:\"Invoices",604080,60,709584,67,764416,41,"nvoice",604271,64,612952,168,596825,32,"Invoices",613129,3524,"secure",616653,138,",permissionFor:\"Invoices",616790,1398,587886,38,618509,55,"},{text:\"Time\",itemId:\"time\",permissionFor:\"Timesheets_BillEntry\"",618594,37,"permissionFor:\"ExpenseClaims_BillEntry\"}],",618187,55,"d){",567119,42,"var b",618895,34,618331,87,"e){this.hide();a.call(d,e.getItemId())},scope:this}});var c=0;this.items.forEach(function(e){if(!e.permissionFor||RM.PermissionsMgr.getPermission(e.permissionFor)){b.add(e);if(e.itemId){c+=1}}});if(c>1){this.popup=b;b.show()}else{a.call(d,this.items[1].itemId)}",603904,47,618701,4858," RM.CashbookMgr.getSalesPreferences().ApprovalProcessEnabled?\"INVOICED\":\"UN",623631,37,623601,100,"getInitialInvoiceStatus:function(){if(RM.CashbookMgr.getSalesPreferences().ApprovalProcessEnabled){return RM.Consts.InvoiceStatus.DRAFT}else{return",623519,33,"}",623699,235,"this.getInitialInvoiceStatus()",623963,2399,626383,1830,"RM.CashbookMgr.getCashbookId()){RM.CashbookMgr.loadLastCashbook(function(){RM.ViewMgr.back()})}else{RM.CashbookMgr",628326,169,"RM.CashbookMgr.selectCashBook()}},this",629460,177,"RM.CashbookMgr",629641,3044,"qa",632689,275,"qa",632731,33,"r1mobileqa",632853,35,632967,462,633428,5828,"QA Server\",value:\"qa",639240,34095,738029,46,673390,3950,"RM.component.SecurePanel,xtype:\"invoices\",config:{permissionFor:\"Invoices",604080,99,677472,158,577833,35,"\"Invoices",569904,99,677727,4918,"util.FormUtils\",{singleton:true,makeAllFieldsReadOnly:function(a){a",594797,122,680160,35,708203,57,682720,1217,",dateFld:{change:\"onInvoiceDateChange",719263,93,647024,107,684134,75,"InvoicesMgr.getInitialInvoiceStatus()",685056,46,",Date:new Date(),Discount:\"None\"",684281,76,"&&RM.PermissionsMgr.canAddEdit(\"Invoices\"",684356,242,684688,299,"this.detailsData;if(b.CustomerId){",687196,34,685274,44,"applyTaxRules(",685311,158,";this.getLineItems().setInvoiceDate(this.getDateFld().getValue());this.getLineItems().setTaxStatus(b.AmountTaxStatus",684591,66,"b.Status));this.dataLoaded=true}}",681326,45,685536,94,"if(!a){RM.util.FormUtils.makeAllFieldsReadOnly(this.getInvoiceForm())}",685773,38,"applyTaxRules:function(){var b=this.getAmountsFld();var a=RM.CashbookMgr.getTaxPreferences();b.setReadOnly(!this.isEditable||!a.AllowTaxEdit);if(this.isCreate){if(a.IsTaxTracking){b.setHidden(false);b.setValue(a.SalesFigures)}else{b.setHidden(true);b.setValue(RM.Consts.TaxStatus.NON_TAXED)}}else{var c=a.IsTaxTracking||b.getValue()!==RM.Consts.TaxStatus.NON_TAXED;b.setHidden(!c)",647892,55,685863,49,684593,64,"c.Status));",685912,378,"applyTaxRules",687532,32,686314,77,"CustomerId(c.CustomerId);b.setTaxStatus(c.AmountTaxStatus);b.setInvoiceDate(c.Date",686535,63,";if(this.detailsData.Paid>0){this.isEditable=false;this.setEditable(false)}this.dataLoaded=true",686598,908,"c,a,b",687507,57,"c.getValue();this.getLineItems().setTaxStatus(b)},onInvoiceDateChanged:function(b,a,c){if(!this.dataLoaded){return}this.calculateBreakdown();this.getLineItems().setInvoiceDate(c",687575,476,"g=",686888,34,"f",688088,39,"e={InvoiceDate:g.Date,AmountTaxStatus:g",688166,87,"g.Discount.indexOf(\"%\")>-1){e.DiscountPercentage=g",688303,34,"g.Discount.indexOf(\"$\")>-1){e.DiscountAmount=g",688383,41,"f.length;c++){var d=f[c];var b={ItemType:d.ItemType,ItemID:d.ItemId,Quantity:d.Quantity",695114,33,"TaxGroupID:d.TaxGroupId,Tax:d.Tax,TaxIsModified:d.TaxIsModified};if(d",688580,36,"d.DiscountPerc}if(d",688641,34,"d.DiscountAmount}e",688696,62,"e,function a(h){var m=h[0];var l=this.detailsData;l.Amount=m.InvoiceAmount;l.Tax=m.InvoiceTax?m.InvoiceTax:0;l.Subtotal=m.Subtotal;l.DiscountTotal=m.Discount?m.Discount:0;l.Paid=m.AmountPaid;l.BalanceDue=m.BalanceDue;var k=this.getLineItems();k.removeAllItems();for(var j=0;j<f.length;j++){f[j].Amount=m.Items[j].Amount;if(m.Items[j].DiscountAmount){f[j].DiscountAmount=m.Items[j].DiscountAmount}}k.setTaxStatus(e.AmountTaxStatus);k.addLineItems(f",689292,42,"h){alert(h",689344,1695,606952,220,"this.on(\"keyup\",this.valChange);this.on(\"blur\",this.numberPrecision",595246,216,",valChange:function(a,f,c){var g=this.getValue();console.log(f.browserEvent.keyCode);if(!(47<f.browserEvent.keyCode<58||f.browserEvent.keyCode==190)){f.stopEvent()}if(g===null||g===undefined){console.log(g);return}var b=g.toString();var d=b.length;if(this.config.decimalPlaces&&b.indexOf(\".\")!=-1){if(d-1>(b.indexOf(\".\")+this.config.decimalPlaces)){this.setValue(b.substring(0,d-1))}}console.log(this.getValue()",637232,49,"&&Ext.isNumber(this.config.decimalPlaces)){this.setValue(a.toFixed(this.config.decimalPlaces))",691019,401,596825,32,"Invoices",691429,40,691483,71,604991,36,691720,58,604763,48,608374,32,"permissionFor:{action:\"Select\",name:\"Projects\"},",605017,53,691801,99,"itemId:\"descriptionField",691898,41,"[\"rm-flatfield\",\"rm-flatfield-last\"],placeHolder:\"enter\"},{xtype:\"panel\",itemId:\"detailsFields\",defaults:{clearIcon:false},hidden:true,items:[",691975,39,692019,189,592877,56,"[\"rm-flatfield\"]",692110,32,"Amount\",label:\"Amount\",value:0",716504,33,614078,33,"Tax cod",673148,37,692272,138,"numberfield\",name:\"Tax\",label:\"Tax\",cls:[\"rm-flatfield\",\"rm-flatfield-last\"]}]}]}]},showDetailsFields:function(){this.down(\"#descriptionField\").removeCls([\"rm-flatfield-last\"]);this.down(\"#detailsFields\").setHidden(false)},hideDetailsFields:function(){this.down(\"#descriptionField\").addCls(\"rm-flatfield-last\");this.down(\"#detailsFields\").setHidden(true",743294,32,692584,183,692774,34,":\"invoicelineitem field[name=UnitPrice]\",quantity:\"invoicelineitem ",692903,47,"field[name=TaxGroupId]\",tax:\"invoicelineitem field[name=Tax]\",amount:\"invoicelineitem field[name=Amount",692977,32,693016,49,693071,196,",unitPrice:{change:\"unitPriceChanged\"},tax:{change:\"taxAmountChanged\"},quantity:{change:\"quantityChanged\"}}},isTaxInclusive:function(){return this.taxStatusCode===RM.Consts.TaxStatus.INCLUSIVE},showView:function(e,f,d,g,a,c",693299,70,"taxStatusCode=d.taxStatus;this.invoiceDate=d.invoiceDate",721615,36,693418,236,",TaxIsModified:false",693654,603,"if(!this.isTaxInclusive()){this.getUnitPrice().setValue(this.detailsData.UnitPriceExTax)}this.getTaxCode().setHidden(this.taxStatusCode===RM.Consts.TaxStatus.NON_TAXED);if(this.detailsData.ItemId){this.getItemDetail().showDetailsFields()}",694304,45,"if(!a){RM.util.FormUtils.makeAllFieldsReadOnly(this.getItemForm())}",694496,482,"this.itemChanged(c[0]",695178,220,"!a.UnitPriceExTax){this.getUnitPrice",695296,37,695503,270,"Tax:c.Tax,TaxIsModified:this.detailsData.TaxIsModified,UnitPriceExTax:this.detailsData",695789,306,",itemChanged:function(a){this.detailsData.ItemName=a.Name;this.detailsData.UnitPriceExTax=a.UnitPriceExTax;this.detailsData.TaxIsModified=false;this.ignoreEvents=tru",695020,39,"a.ItemId,ItemName:a.ItemPath,TaxGroupId:a.SaleTaxCodeID,Description:a.SalesDescription,UnitPrice:a.UnitPriceExTax});this.ignoreEvents=false;this.getServerCalculatedValues()},unitPriceChanged:function(c,b,a){if(!this.initShow||this.ignoreEvents){return}if(b===a){return}if(this.isTaxInclusive()){this.detailsData.TaxIsModified=false;this.getServerCalculatedValues(b)}else{this.detailsData.UnitPriceExTax=b;this.getServerCalculatedValues()}},taxAmountChanged:function(c,b,a){if(!this.initShow||this.ignoreEvents){return}this.detailsData.TaxIsModified=true;this.getServerCalculatedValues()},projectChanged:function(){},quantityChanged:function(){if(!this.initShow||this.ignoreEvents){return}this.getServerCalculatedValues()},getServerCalculatedValues:function(b){var d={AmountTaxStatus:this.taxStatusCode,PreviousAmountTaxStatus:this.taxStatusCode,CustomerId:this.customerId,InvoiceDate:this.invoiceDate,LineItems:[]};var c",746155,36,"e={ItemId:c.ItemId,Quantity:c.Quantity,TaxGroupID:c.TaxGroupId,Tax:c.Tax,Amount:c.Amount,TaxIsModified:this.detailsData.TaxIsModified,UnitPriceExTax:this.detailsData.UnitPriceExTax",695830,33,"e",695864,89,"e",695954,59,"b){e.UnitPrice=b}d.LineItems.push(e",690764,34,"Calc\",true,d,function a(g){var f=g[0].Items[0];this.detailsData.UnitPriceExTax=f.UnitPriceExTax;this.ignoreEvents=tru",695020,32,"UnitPrice:this.isTaxInclusive()?f.UnitPrice:f.UnitPriceExTax,Amount:f.Amount,Tax:f.Tax});this.getItemDetail().showDetailsFields();this.ignoreEvents=false},this,function(f){alert(f)},\"Working...\"",743294,32,696125,1450,"RM.component.Secure",697579,40,"permissionFor:\"Invoices",604080,60,709584,121,697798,12863,"'+(a.AmountTaxStatus!==RM.Consts.TaxStatus.NON_TAXED?'",710783,48,"Tax",710463,51,"2}</span></div></tr>':\"\")+'",710783,2460,"var a=!(",713277,59,"&&RM.PermissionsMgr.canApprove(\"Invoices\"",713240,36,"a);var b=!(",713460,58,"&&RM.PermissionsMgr.canApprove(\"Invoices\"",713424,35,"b",713336,90,713519,1466,715847,9389,"text",725242,1110,726367,11576,"secure",737943,575,",permissionFor:{name:\"SalesPreferences\",action:\"View\"}",738518,228,",listeners:{focus:function(b){var a=b.getValue().split(\"\\n\").length;b.setMaxRows(a+2)},keyup:function(b){var a=b.getValue().split(\"\\n\").length;b.setMaxRows(a+2)}}}]",739024,103,"0",749549,79,"sent",739212,38,749679,54,738751,100,"2",673819,79,739207,24999,55391,32,".prototype.isNotPreventable=/^(select|a|input|textarea)$/i",764206,682]